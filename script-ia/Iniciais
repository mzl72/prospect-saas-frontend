##1 - Esse √© o documento que utilizamos (N√£o est√° completo pois √© muito grande, vou te passar somente o necess√°rio):
Plano de Desenvolvimento - 3 Semanas (MVP 100% Funcional)
Objetivo: Sistema de prospec√ß√£o B2B inspirado no Meta Ads com campanhas de extra√ß√£o e envio automatizado.
üìä Estado Atual (Fase 0 - Conclu√≠do)
‚úÖ Infraestrutura
Docker Compose: PostgreSQL, Redis, Evolution API, N8N, Adminer
Next.js 15.5.3 + React 19 + TypeScript + Tailwind v4
Prisma ORM com schema inicial (User, Campaign, Lead)
TanStack Query v5 + Zustand stores
Entre outras necess√°rias
‚úÖ Funcionalidades Implementadas
Wizard 3 etapas para cria√ß√£o de campanha (tipo neg√≥cio, localiza√ß√£o, quantidade, n√≠vel)
Sistema de cr√©ditos (BASICO: 0.25, COMPLETO: 1.0)
POST /api/campaigns ‚Üí chama N8N webhook
Webhook handlers: leads-extracted, lead-enriched, campaign-completed
Reembolso autom√°tico (duplicatas + leads n√£o encontrados)
Rate limiting por usu√°rio + IP
Sanitiza√ß√£o XSS + NoSQL injection
Valida√ß√£o de ownership (campanhas/leads)
‚úÖ Fluxos N8N Atuais
Fluxo 1 (Extra√ß√£o): Apify Google Maps ‚Üí webhook leads-extracted ‚Üí dispara Fluxo 2 se completo
Fluxo 2 (Enriquecimento): Perplexity + GPT-4o-mini ‚Üí gera 3 mensagens (email/whatsapp/hybrid) ‚Üí webhook lead-enriched
‚úÖ UI Atual
Landing page (/)
Wizard de gera√ß√£o (/gerar)
Lista de campanhas (/campanhas)
Detalhes de campanha (/campanhas/[id])
Sidebar com navega√ß√£o
‚ö†Ô∏è Limita√ß√µes Atuais
Usa DEMO_USER_ID hardcoded (sem auth)
N√£o envia mensagens reais (apenas prepara dados)
Sem templates customiz√°veis
Sem campanhas de envio
Sem captura de respostas
UI n√£o segue padr√£o Meta Ads
üéØ Arquitetura Alvo (MVP 3 Semanas)
Resumo Executivo
Este roteiro divide a evolu√ß√£o do sistema em 3 sprints l√≥gicos e incrementais. Ao iniciar uma tarefa, identifique em qual semana ela se encaixa para manter o contexto:
SEMANA 1 (Funda√ß√£o & Estrutura): Foco em Infraestrutura e CRUDs. O objetivo √© preparar o sistema multi-usu√°rio (NextAuth, Roles), estabelecer o novo layout do Dashboard (estilo Meta Ads) e criar as interfaces de gerenciamento base (Templates, Configura√ß√µes de API/Email).
SEMANA 2 (Motor de Envio): Foco em L√≥gica de Neg√≥cio e Integra√ß√µes. O objetivo √© fazer o sistema funcionar. Inclui o Wizard de Campanhas de Envio, o motor de agendamento/cad√™ncia (Cron Jobs), e as integra√ß√µes reais de envio (Evolution API para WhatsApp, Resend para Email) e recep√ß√£o (Webhooks).
SEMANA 3 (Dados & Polish): Foco em Visualiza√ß√£o e Estabilidade. O objetivo √© fechar o ciclo. Inclui a exibi√ß√£o de m√©tricas agregadas, hist√≥rico detalhado do Lead, tratamento de respostas de e-mail, testes E2E e polimento final de UI/UX.

Estrutura de Campanhas (igual Meta Ads)
Campanha (Objetivo)
‚îî‚îÄ Conjunto (Configura√ß√µes)
‚îî‚îÄ Criativo (Templates/Mensagens)
3 Tipos de Campanha:
Extra√ß√£o: Google Maps ‚Üí Leads brutos (sem mensagens)
Extra√ß√£o + Enriquecimento: Google Maps ‚Üí IA gera mensagens personalizadas
Envio: Seleciona lista existente ‚Üí Envia com cad√™ncia configurada
Roles & Permiss√µes
Admin: Acesso total (gerenciar usu√°rios, configura√ß√µes, templates, campanhas)
Manager: Criar/editar campanhas e templates, ver m√©tricas (sem acesso a configura√ß√µes/usu√°rios)
Operator: Apenas visualizar campanhas e m√©tricas (sem criar/editar)
Novos Models do Banco
Template (id, tipo, nome, conte√∫do, vari√°veis, createdBy, createdAt)
Message (id, leadId, tipo, ordem, conte√∫do, createdAt)
SendCampaign (id, extractionCampaignId, status, scheduleConfig, cadenceConfig)
SentMessage (id, messageId, sendCampaignId, leadId, channel, status, sentAt, deliveredAt, openedAt, respondedAt)
LeadResponse (id, leadId, channel, message, receivedAt)
User (adicionar: role, tenancyId, tenancyName)
EvolutionInstance (id, name, apiUrl, apiKey, isActive)
EmailSender (id, email, resendKey, fromName, isActive)
UI Nova (Meta Ads Style)
/ ‚Üí Landing page
/login ‚Üí Auth
/dashboard ‚Üí M√©tricas gerais (leads, convers√µes, cr√©ditos)
/dashboard/campanhas ‚Üí Lista com tabs (Todas, Ativas, Pausadas, Conclu√≠das)
/dashboard/campanhas/[id] ‚Üí Detalhes + leads + m√©tricas
/dashboard/templates ‚Üí CRUD templates (Email, WhatsApp, Prompts IA)
/dashboard/configuracoes ‚Üí Inst√¢ncias Evolution, Email Senders, Dados Empresa, Usu√°rios
üìÖ SEMANA 1 - Funda√ß√£o & Refatora√ß√£o
üóìÔ∏è DIA 1 (Segunda) - Auth & Database Schema
Planejamento (20min)
Revisar schema atual vs schema alvo
Definir migrations strategy (criar novas tabelas sem quebrar existentes)
Planejar estrutura de roles/permiss√µes
Desenvolvimento
[ ] Instalar NextAuth.js + Prisma Adapter
[ ] Criar migrations:
Adicionar role, tenancyId, tenancyName em User
Criar tabela Account (NextAuth)
Criar tabela Session (NextAuth)
[ ] Configurar NextAuth providers (Email magic link)
[ ] Criar middleware de prote√ß√£o de rotas
[ ] Implementar helper getServerSession()
[ ] Criar seed para usu√°rio admin inicial
Testes
Login com email funciona
Middleware bloqueia rotas protegidas
Session persiste ap√≥s reload
Documenta√ß√£o
Atualizar README.md (se√ß√£o autentica√ß√£o)
Criar src/lib/auth/README.md
üóìÔ∏è DIA 2 (Ter√ßa) - UI Refactor - Dashboard Layout
Planejamento (20min)
Estudar estrutura de tabs do Meta Ads
Definir componentes reutiliz√°veis (DashboardLayout, Tabs, Filters)
Desenvolvimento
[ ] Criar /dashboard route group (layout compartilhado)
[ ] Criar DashboardLayout (Sidebar + TopBar + Breadcrumbs)
[ ] Criar componente Tabs reutiliz√°vel
[ ] Criar componente FilterBar (search, status, date range)
[ ] Refatorar Sidebar (adicionar links Dashboard, Templates, Configura√ß√µes)
[ ] Criar p√°gina /dashboard (m√©tricas placeholder)
[ ] Migrar /campanhas ‚Üí /dashboard/campanhas
Testes
Navega√ß√£o entre tabs funciona
Sidebar destaca rota ativa
Layout responsivo
Documenta√ß√£o
Atualizar src/components/README.md
Adicionar screenshot do layout
üóìÔ∏è DIA 3 (Quarta) - Campanhas List (Meta Ads Style)
Planejamento (20min)
Definir colunas da tabela (Nome, Status, Tipo, Resultados, Gasto, Data)
Planejar filtros e a√ß√µes em massa
Desenvolvimento
[ ] Criar componente CampaignTable (sortable columns)
[ ] Implementar tabs: Todas, Ativas, Pausadas, Conclu√≠das
[ ] Adicionar filtros: tipo, data, busca
[ ] Implementar a√ß√µes em massa (pausar, retomar, arquivar)
[ ] Adicionar m√©tricas inline (total enviado, taxa resposta, custo)
[ ] Criar bot√£o "Criar" com dropdown (3 tipos de campanha)
[ ] Estilizar igual Meta Ads (cores, espa√ßamentos, badges)
Testes
Filtros funcionam corretamente
A√ß√µes em massa atualizam m√∫ltiplas campanhas
Ordena√ß√£o por coluna funciona
Documenta√ß√£o
Atualizar src/app/dashboard/campanhas/README.md
üóìÔ∏è DIA 4 (Quinta) - Templates CRUD - Backend
Planejamento (20min)
Definir schema Template
Planejar valida√ß√£o de vari√°veis {nomeEmpresa}
Estruturar tipos de template (EMAIL, WHATSAPP, PROMPT_IA)
Desenvolvimento
[ ] Criar migration: tabela Template
[ ] Criar Zod schema: CreateTemplateSchema, UpdateTemplateSchema
[ ] Criar API routes:
GET /api/templates (listar com filtro por tipo)
POST /api/templates (criar com valida√ß√£o de vari√°veis)
PATCH /api/templates/[id] (atualizar)
DELETE /api/templates/[id] (soft delete)
[ ] Implementar valida√ß√£o de permiss√µes (Manager+ pode criar)
[ ] Criar helper extractVariables(template) ‚Üí string[]
[ ] Adicionar templates padr√£o no seed
Testes
CRUD completo funciona
Valida√ß√£o de vari√°veis detecta {variavel} corretamente
Permiss√µes impedem Operator de criar
Documenta√ß√£o
Criar src/app/api/templates/README.md
üóìÔ∏è DIA 5 (Sexta) - Templates CRUD - Frontend
Planejamento (20min)
Definir UI de listagem (cards vs tabela)
Planejar modal de cria√ß√£o/edi√ß√£o
Desenvolvimento
[ ] Criar p√°gina /dashboard/templates
[ ] Implementar tabs: Email, WhatsApp, Prompts IA
[ ] Criar componente TemplateCard (preview + a√ß√µes)
[ ] Criar modal CreateTemplateDialog
[ ] Implementar editor com syntax highlight de vari√°veis
[ ] Adicionar preview de template com dados de exemplo
[ ] Criar bot√£o "Duplicar template"
[ ] Adicionar biblioteca de templates prontos (categorias)
Testes
Criar template funciona
Vari√°veis s√£o destacadas visualmente
Preview renderiza vari√°veis corretamente
Documenta√ß√£o
Atualizar src/components/README.md (adicionar TemplateCard)
üóìÔ∏è DIA 6 (S√°bado) - Configura√ß√µes - Inst√¢ncias
Planejamento (20min)
Definir schema EvolutionInstance e EmailSender
Planejar teste de conex√£o (ping Evolution API)
Desenvolvimento
[ ] Criar migrations:
Tabela EvolutionInstance
Tabela EmailSender
[ ] Criar API routes:
GET /api/config/evolution-instances
POST /api/config/evolution-instances (com teste de conex√£o)
PATCH /api/config/evolution-instances/[id]/toggle (ativar/desativar)
[ ] Criar helper testEvolutionConnection(apiUrl, apiKey)
[ ] Criar API routes para EmailSender (similar)
[ ] Implementar permiss√µes (apenas Admin)
Testes
Teste de conex√£o Evolution API funciona
Toggle ativa/desativa inst√¢ncia
Apenas Admin acessa
Documenta√ß√£o
Criar src/app/api/config/README.md
üóìÔ∏è DIA 7 (Domingo) - Configura√ß√µes - Frontend
Planejamento (20min)
Definir layout de configura√ß√µes (tabs laterais)
Planejar valida√ß√£o de formul√°rios
Desenvolvimento
[ ] Criar p√°gina /dashboard/configuracoes
[ ] Implementar tabs: Empresa, Evolution API, Email, Usu√°rios
[ ] Criar form Dados da Empresa (nome, site, descri√ß√£o)
[ ] Criar lista de EvolutionInstances (add, edit, test, toggle)
[ ] Criar lista de EmailSenders (add, edit, test, toggle)
[ ] Criar lista de Usu√°rios (convidar por email, alterar role, remover)
[ ] Adicionar indicador visual de conex√£o (verde/vermelho)
Testes
Testar conex√£o mostra feedback visual
Convidar usu√°rio envia email
Alterar role funciona
Documenta√ß√£o
Atualizar README.md (se√ß√£o configura√ß√µes)

1. Liste todos os arquivos existentes no projeto para voc√™ entender a estrutura de pastas e arquivos (obrigat√≥riamente use ls -la)
2. Ap√≥s fazer os ls -la (aguarde): liste todos os arquivos da raiz, prisma/ e src/ com ls (ignore migrations do prisma/ e componentes shadcn)
3. Apenas leia todos os README existentes em todas as pastas. VOC√ä √â OBRIGADO A LER TODOS OS README
   N√£o precisa me dar nenhum relat√≥rio grande, seja conciso para comigo

##2 - 1. Veja todos os arquivos que existem na raiz do projeto e LEIA arquivos mais importantes da raiz (.env, package, src/middleware, todos os arquivos docker, etc). Nunca me d√™ um relat√≥rio grande, n√£o gaste tokens, seja conciso.

2. Leias principais arquivos das pastas types, components (ignorando shadcn), prisma (seed, schema), src/lib e src/hooks (levando em considera√ß√£o que existem subpastas dentro dessas pastas com mais arquivos, leia-os tamb√©m). use find para ver quais s√£o.

Isso evita quebra de c√≥digos, quebra de l√≥gicas, mant√©m a consist√™ncia (frontend, backend e banco de dados), boas pr√°ticas, seguran√ßa, etc... N√£o quero relat√≥rio nem documenta√ß√£o grande, seja sempre conciso para me reportar, a n√£o ser que eu pe√ßa o contr√°rio

##3 - leia principais arquivos dentro de src/app/, src/app/api, src/app/dashboard e src/app/login (lembrando que podem existir subpastas dentro dessas pastas com mais arquovos, leia-os tamb√©m)

Isso evita quebra de c√≥digos, quebra de l√≥gicas, mant√©m a consist√™ncia (frontend, backend e banco de dados), boas pr√°ticas, seguran√ßa, etc... N√£o quero relat√≥rio nem documenta√ß√£o grande, seja sempre conciso para me reportar, a n√£os er que eu pe√ßa o contr√°rio
