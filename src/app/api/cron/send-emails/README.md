# send-emails - Envio Automático e Distribuído de Emails

**route.ts**: Cron job GET (executa a cada 5min) com autenticação via validateCronAuth (header). maxDuration 300s. Fluxo: busca UserSettings, verifica limite diário (getSentTodayStats retorna seq1/seq2/seq3/total), checa se pode enviar com canSendMoreToday, valida delay automático via getSendLog + canSendNow, determina próxima sequência com distribuição equilibrada (getNextSequenceToSend), busca 1 email PENDING da sequência escolhida com cadenceType EMAIL_ONLY ou HYBRID, valida timing com canSendEmail (scheduler), envia via sendEmailViaResend, adiciona unsubscribe footer (addUnsubscribeFooter), atualiza Email status para SENT + sentAt, registra ChannelSendLog, calcula nextAllowedSendTime com delay dinâmico (baseado em dailyEmailLimit e business hours), atualiza sendLog. Usa cron-utils para responses padronizados (buildLimitReachedResponse, buildWaitingResponse, buildSuccessResponse). Inclui emails e whatsappMessages do lead para verificar sequência em HYBRID.
