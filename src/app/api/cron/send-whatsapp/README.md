# send-whatsapp - Envio Automático e Distribuído de WhatsApp

**route.ts**: Cron job GET (executa a cada 5min) com autenticação via validateCronAuth. maxDuration 300s. Fluxo idêntico ao send-emails mas para WhatsApp: busca UserSettings, usa whatsappDailyLimit (fallback para dailyEmailLimit), verifica stats com getSentTodayStats('whatsapp'), determina nextSeq com distribuição equilibrada, busca 1 WhatsAppMessage PENDING da sequência com cadenceType WHATSAPP_ONLY ou HYBRID, valida timing com canSendWhatsApp (scheduler), envia via sendWhatsAppMessage (usa round-robin de evolutionInstances), adiciona opt-out footer (addOptOutFooter), atualiza WhatsAppMessage status para SENT + sentAt, registra ChannelSendLog, calcula nextAllowedSendTime com whatsappBusinessHourStart/End, atualiza sendLog('whatsapp'). Inclui emails + whatsappMessages do lead para verificar sequência em HYBRID. Responses padronizados via cron-utils.
